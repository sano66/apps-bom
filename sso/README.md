
# Spring Security 学習プロジェクト

自分用のSpring Security の学習です。

## 認証シナリオ

1. シングルサインオン経由でアクセスするウェブアプリケーションを想定
1. シングルサインオンはユーザ名、パスワードで認証済の前提
1. シングルサインオン認証が済んでいる場合はhttpヘッダーにSSO_USERが付与されている
1. ウェブアプリケーションを利用するにはシングルサインオンの認証とは別に、店識別とSSO_USERで指定したユーザ名による認証が必要
1. アプリケーションの認証ができなかった場合は、店識別とユーザ名のログインフォームを表示する
1. 認証未済の場合、店識別をリクエストパラメータで指定した場合は、認証済のSSO_USERとあわせてログイン認証を実施する
1. 店識別とはNYとかPARISとか店が存在する地名を表す任意の用語

### おまけ

1. デバッグのため/debug.jsp, /permit_all.htmlは誰でもアクセス可能にする
1. アプリケーションのログインフォームはJSPではなくサーブレットで作成し、認証・認可のパッケージの可搬性を高める

## Step 1 認証対象外のページの設定、リクエストヘッダーをチェックするフィルターの設定

1. デバッグのため/debug.jsp, /permit_all.htmlは誰でもアクセス可能にする
1. リクエストヘッダーをチェックするフィルタの定義

### point

1. configure(WebSecurity)で認証対象外のページを設定する
1. シングルサインオン認証が済んでいるかどうかを、httpヘッダーのSSO_USERの有無で判断するフィルタを作成する
1. configure(HttpSecurity)でリクエストヘッダーをチェックするフィルタを登録する
1. 上記フィルタで使用するtokenに応じた認証プロバイダの登録
1. フィルタが設定するtoken.detailはGrantedAuthorityを実装していること

## 利用規約

誤りがあれば遠慮なくご指摘ください。